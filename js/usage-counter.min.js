"use strict";
(function () {
var STORAGE_KEY = "devtoolbox-usage";
function getUsageData() {
try {
var data = localStorage.getItem(STORAGE_KEY);
return data ? JSON.parse(data) : {};
} catch (e) {
return {};
}
}
function saveUsageData(usage) {
try {
localStorage.setItem(STORAGE_KEY, JSON.stringify(usage));
} catch (e) {
}
}
function getSlug() {
var path = window.location.pathname;
var match = path.match(/\/tools\/([^/]+)\/?$/);
return match ? match[1] : null;
}
function getCount(slug) {
var usage = getUsageData();
return usage[slug] || 0;
}
function incrementCount(slug) {
var usage = getUsageData();
usage[slug] = (usage[slug] || 0) + 1;
saveUsageData(usage);
return usage[slug];
}
function renderCounter(slug) {
var count = getCount(slug);
var container = document.querySelector(".tool-container");
if (!container) return;
var el = document.createElement("div");
el.className = "usage-counter";
el.id = "usage-counter";
el.innerHTML = 'このツールは <span class="usage-counter__number">' + count + '</span> 回使用されました';
container.parentNode.insertBefore(el, container.nextSibling);
}
function updateCounterDisplay(count) {
var numEl = document.querySelector(".usage-counter__number");
if (numEl) {
numEl.textContent = count;
}
}
function initUsageTracking(slug) {
var buttons = document.querySelectorAll(".btn--primary");
buttons.forEach(function (btn) {
btn.addEventListener("click", function () {
var newCount = incrementCount(slug);
updateCounterDisplay(newCount);
});
});
}
document.addEventListener("DOMContentLoaded", function () {
var slug = getSlug();
if (!slug) return;
renderCounter(slug);
initUsageTracking(slug);
});
})();
