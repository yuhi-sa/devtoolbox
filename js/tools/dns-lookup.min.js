"use strict";
(function () {
document.addEventListener("DOMContentLoaded", function () {
var recordTypes = [
{ type: "A", desc: "ドメイン名をIPv4アドレスに変換", example: "example.com. IN A 93.184.216.34", useCase: "Webサイトのホスティング、サーバーへの接続" },
{ type: "AAAA", desc: "ドメイン名をIPv6アドレスに変換", example: "example.com. IN AAAA 2606:2800:220:1:248:1893:25c8:1946", useCase: "IPv6対応のサーバーへの接続" },
{ type: "CNAME", desc: "ドメインの別名（エイリアス）を定義", example: "www.example.com. IN CNAME example.com.", useCase: "サブドメインの別名設定、CDNへの接続" },
{ type: "MX", desc: "メールサーバーの指定と優先度を定義", example: "example.com. IN MX 10 mail.example.com.", useCase: "メール配信先サーバーの指定" },
{ type: "TXT", desc: "任意のテキスト情報を格納", example: "example.com. IN TXT \"v=spf1 include:_spf.google.com ~all\"", useCase: "SPF、DKIM、ドメイン所有権の検証" },
{ type: "NS", desc: "ドメインの権威DNSサーバーを指定", example: "example.com. IN NS ns1.example.com.", useCase: "DNSの委任、ネームサーバーの指定" },
{ type: "SOA", desc: "ゾーンの管理情報（権威、シリアル番号等）を定義", example: "example.com. IN SOA ns1.example.com. admin.example.com. 2024010101 3600 900 1209600 86400", useCase: "ゾーンの管理、同期設定" },
{ type: "PTR", desc: "IPアドレスからドメイン名への逆引き", example: "34.216.184.93.in-addr.arpa. IN PTR example.com.", useCase: "逆引きDNS、メールサーバーの信頼性検証" },
{ type: "SRV", desc: "サービスのホスト名とポート番号を指定", example: "_sip._tcp.example.com. IN SRV 10 60 5060 sipserver.example.com.", useCase: "SIP、XMPP、LDAPなどのサービス検出" },
{ type: "CAA", desc: "ドメインに対しSSL証明書を発行できるCAを制限", example: "example.com. IN CAA 0 issue \"letsencrypt.org\"", useCase: "SSL証明書の発行制御、セキュリティ強化" }
];
function escapeHtml(str) {
return str
.replace(/&/g, "&amp;")
.replace(/</g, "&lt;")
.replace(/>/g, "&gt;")
.replace(/"/g, "&quot;");
}
var refBody = document.getElementById("dns-ref-body");
var refHtml = "";
for (var i = 0; i < recordTypes.length; i++) {
var r = recordTypes[i];
refHtml += "<tr>";
refHtml += "<td><code>" + escapeHtml(r.type) + "</code></td>";
refHtml += "<td>" + escapeHtml(r.desc) + "</td>";
refHtml += "<td><code>" + escapeHtml(r.example) + "</code></td>";
refHtml += "<td>" + escapeHtml(r.useCase) + "</td>";
refHtml += "</tr>";
}
refBody.innerHTML = refHtml;
var tabBtns = document.querySelectorAll(".tab-btn");
for (var t = 0; t < tabBtns.length; t++) {
tabBtns[t].addEventListener("click", function () {
for (var j = 0; j < tabBtns.length; j++) {
tabBtns[j].classList.remove("active");
}
this.classList.add("active");
var contents = document.querySelectorAll(".tab-content");
for (var k = 0; k < contents.length; k++) {
contents[k].classList.remove("active");
}
document.getElementById("tab-" + this.getAttribute("data-tab")).classList.add("active");
});
}
var recordTypeSelect = document.getElementById("record-type");
var recordName = document.getElementById("record-name");
var recordTtl = document.getElementById("record-ttl");
var dynamicFields = document.getElementById("dynamic-fields");
var btnAddRecord = document.getElementById("btn-add-record");
var recordList = document.getElementById("record-list");
var zoneOutput = document.getElementById("zone-output");
var btnCopyZone = document.getElementById("btn-copy-zone");
var zoneSuccess = document.getElementById("zone-success");
var records = [];
var fieldConfigs = {
A: [{ id: "f-ipv4", label: "IPv4アドレス", placeholder: "例: 93.184.216.34" }],
AAAA: [{ id: "f-ipv6", label: "IPv6アドレス", placeholder: "例: 2606:2800:220:1:248:1893:25c8:1946" }],
CNAME: [{ id: "f-target", label: "ターゲットドメイン", placeholder: "例: example.com." }],
MX: [
{ id: "f-priority", label: "優先度", placeholder: "例: 10", type: "number" },
{ id: "f-mailserver", label: "メールサーバー", placeholder: "例: mail.example.com." }
],
TXT: [{ id: "f-text", label: "テキスト値", placeholder: "例: v=spf1 include:_spf.google.com ~all" }],
NS: [{ id: "f-nameserver", label: "ネームサーバー", placeholder: "例: ns1.example.com." }],
SOA: [
{ id: "f-mname", label: "プライマリNS", placeholder: "例: ns1.example.com." },
{ id: "f-rname", label: "管理者メール", placeholder: "例: admin.example.com." },
{ id: "f-serial", label: "シリアル番号", placeholder: "例: 2024010101", type: "number" },
{ id: "f-refresh", label: "リフレッシュ（秒）", placeholder: "3600", type: "number" },
{ id: "f-retry", label: "リトライ（秒）", placeholder: "900", type: "number" },
{ id: "f-expire", label: "有効期限（秒）", placeholder: "1209600", type: "number" },
{ id: "f-minimum", label: "ネガティブTTL（秒）", placeholder: "86400", type: "number" }
],
PTR: [{ id: "f-ptrdname", label: "ドメイン名", placeholder: "例: example.com." }],
SRV: [
{ id: "f-srv-priority", label: "優先度", placeholder: "10", type: "number" },
{ id: "f-srv-weight", label: "重み", placeholder: "60", type: "number" },
{ id: "f-srv-port", label: "ポート", placeholder: "5060", type: "number" },
{ id: "f-srv-target", label: "ターゲット", placeholder: "例: sipserver.example.com." }
],
CAA: [
{ id: "f-caa-flags", label: "フラグ", placeholder: "0", type: "number" },
{ id: "f-caa-tag", label: "タグ（issue/issuewild/iodef）", placeholder: "issue" },
{ id: "f-caa-value", label: "値", placeholder: "例: letsencrypt.org" }
]
};
function renderDynamicFields() {
var type = recordTypeSelect.value;
var config = fieldConfigs[type] || [];
var html = "";
for (var i = 0; i < config.length; i++) {
var f = config[i];
html += '<div class="builder-row">';
html += '<label for="' + f.id + '">' + escapeHtml(f.label) + '</label>';
html += '<input type="' + (f.type || "text") + '" id="' + f.id + '" placeholder="' + escapeHtml(f.placeholder) + '">';
html += '</div>';
}
dynamicFields.innerHTML = html;
}
renderDynamicFields();
recordTypeSelect.addEventListener("change", renderDynamicFields);
function buildZoneLine(type, name, ttl, fields) {
var line = name + " " + ttl + " IN " + type + " ";
switch (type) {
case "A":
line += fields[0];
break;
case "AAAA":
line += fields[0];
break;
case "CNAME":
line += fields[0];
break;
case "MX":
line += fields[0] + " " + fields[1];
break;
case "TXT":
line += '"' + fields[0] + '"';
break;
case "NS":
line += fields[0];
break;
case "SOA":
line += fields[0] + " " + fields[1] + " (" +
"\n    " + fields[2] + " ; serial" +
"\n    " + fields[3] + " ; refresh" +
"\n    " + fields[4] + " ; retry" +
"\n    " + fields[5] + " ; expire" +
"\n    " + fields[6] + " ; minimum TTL" +
"\n)";
break;
case "PTR":
line += fields[0];
break;
case "SRV":
line += fields[0] + " " + fields[1] + " " + fields[2] + " " + fields[3];
break;
case "CAA":
line += fields[0] + " " + fields[1] + ' "' + fields[2] + '"';
break;
}
return line;
}
function renderRecords() {
var html = "";
for (var i = 0; i < records.length; i++) {
html += '<div class="record-item">';
html += '<span>' + escapeHtml(records[i]) + '</span>';
html += '<button data-index="' + i + '" title="削除">&times;</button>';
html += '</div>';
}
recordList.innerHTML = html;
zoneOutput.value = records.join("\n");
var deleteBtns = recordList.querySelectorAll("button");
for (var k = 0; k < deleteBtns.length; k++) {
deleteBtns[k].addEventListener("click", function () {
var idx = parseInt(this.getAttribute("data-index"), 10);
records.splice(idx, 1);
renderRecords();
});
}
}
btnAddRecord.addEventListener("click", function () {
var type = recordTypeSelect.value;
var name = recordName.value.trim() || "@";
var ttl = recordTtl.value || "3600";
var config = fieldConfigs[type] || [];
var fields = [];
for (var i = 0; i < config.length; i++) {
var el = document.getElementById(config[i].id);
var val = el ? el.value.trim() : "";
if (!val) {
return;
}
fields.push(val);
}
var line = buildZoneLine(type, name, ttl, fields);
records.push(line);
renderRecords();
});
btnCopyZone.addEventListener("click", function () {
var text = zoneOutput.value;
if (!text) return;
navigator.clipboard.writeText(text).then(function () {
zoneSuccess.textContent = "コピーしました。";
zoneSuccess.hidden = false;
setTimeout(function () { zoneSuccess.hidden = true; }, 2000);
});
});
var templates = [
{
name: "基本的なWebサイト",
desc: "シンプルなWebサイトのDNS設定。ルートドメインとwwwサブドメインを設定します。",
zone: "; Basic Website DNS Configuration\n@ 3600 IN A 93.184.216.34\nwww 3600 IN CNAME @\n@ 3600 IN NS ns1.example.com.\n@ 3600 IN NS ns2.example.com."
},
{
name: "メール設定（Google Workspace）",
desc: "Google Workspaceでメールを利用する場合のDNS設定。MXレコードとSPFレコードを含みます。",
zone: "; Google Workspace Email Configuration\n@ 3600 IN MX 1 aspmx.l.google.com.\n@ 3600 IN MX 5 alt1.aspmx.l.google.com.\n@ 3600 IN MX 5 alt2.aspmx.l.google.com.\n@ 3600 IN MX 10 alt3.aspmx.l.google.com.\n@ 3600 IN MX 10 alt4.aspmx.l.google.com.\n@ 3600 IN TXT \"v=spf1 include:_spf.google.com ~all\""
},
{
name: "サブドメインリダイレクト",
desc: "ブログやAPIなど、サブドメインを別のサーバーに向ける設定。",
zone: "; Subdomain Redirect Configuration\nblog 3600 IN CNAME blog-host.example.net.\napi 3600 IN A 10.0.0.1\nstaging 3600 IN A 10.0.0.2\n*.dev 3600 IN CNAME dev-server.example.net."
},
{
name: "SSL証明書制限（CAA）",
desc: "Let's Encryptのみに証明書発行を許可するCAA設定。",
zone: "; CAA Record - Let's Encrypt Only\n@ 3600 IN CAA 0 issue \"letsencrypt.org\"\n@ 3600 IN CAA 0 issuewild \"letsencrypt.org\"\n@ 3600 IN CAA 0 iodef \"mailto:admin@example.com\""
}
];
var templateListEl = document.getElementById("template-list");
var tplHtml = "";
for (var tp = 0; tp < templates.length; tp++) {
var tpl = templates[tp];
tplHtml += '<div class="template-card">';
tplHtml += '<h3>' + escapeHtml(tpl.name) + '</h3>';
tplHtml += '<p class="desc">' + escapeHtml(tpl.desc) + '</p>';
tplHtml += '<pre>' + escapeHtml(tpl.zone) + '</pre>';
tplHtml += '<button class="btn btn--secondary copy-btn" data-tpl-index="' + tp + '">コピー</button>';
tplHtml += '</div>';
}
templateListEl.innerHTML = tplHtml;
var tplCopyBtns = templateListEl.querySelectorAll("button[data-tpl-index]");
for (var tb = 0; tb < tplCopyBtns.length; tb++) {
tplCopyBtns[tb].addEventListener("click", function () {
var idx = parseInt(this.getAttribute("data-tpl-index"), 10);
navigator.clipboard.writeText(templates[idx].zone).then(function () {
});
this.textContent = "コピーしました";
var btn = this;
setTimeout(function () { btn.textContent = "コピー"; }, 2000);
});
}
});
})();